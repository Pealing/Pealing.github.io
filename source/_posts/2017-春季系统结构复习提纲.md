---
title: 2017-春季系统结构复习提纲
date: 2017-05-28 20:12:46
updated: 2017-05-28 20:12:46
tags:
categories: "春季复习提纲"
---
# 前言
    嗯，复习提纲大家懂的。老规矩，写了没考考了没写我不负责。
    顺便说一句，如果之后有小学弟小学妹要看这份提纲的话，
    记得结合你们老师画的重点，
    据说每年考题范围和重点都会有变动的。

<!--more-->

* 题型：选择、判断、简答、计算、综合题


# 第一章·计算机系统结构导论

##### 透明性
* *系统结构*是指计算机系统中对各级之间界面的定义及其上、下功能的分派。因此，各级都有其自己的系统结构。
*  各级之间存在*透明性*。
*  *透明性*
    * 确实存在
    * 无法检测和设置
    * 在计算机系统中，低层的概念性结构和功能特性，对高层来说是透明的。
    * 从机器（汇编）语言程序员角度看，透明的是：指令缓冲寄存器、时标发生器、乘法器、主存地址寄存器、指令地址寄存器、；
    * 不透明的是：条件码寄存器、磁盘、通用寄存器、中断字寄存器；

##### 计算机系统结构、组成和实现三者的关系
* 系统机构是（1）__________________。
* 计算机组成是（2）________________。
* 计算机实现是（3）________________。
* 指令系统的功能的确定属于（4）______
* 而指令的实现（如取指、取操作数、运算送结果、时序属于）属于（5）________
* 实现这些指令功能的具体电路、器件设计及装配技术等属于（6）_________。
 
---
答案：
(1)指对机器语言计算机的软、硬件功能分配和对计算机系统的软、硬件界面的定义。
(2)计算机系统结构的逻辑实现
(3)计算机组成的物理实现
(4)系统结构
(5)组成
(6)实现

---
* 是否需要乘除指令属于(1)_______。
* 乘除指令是用专门的乘法器、除法器实现，还是用加法器累加配上移位器属于(2)_______。
* 乘法器、除法器、或加法器的物理实现属于(3)_______。
* 主存、主存容量和编制方式（按位、按字节或者按字访问）的确定属于(4)_____。
* 主存的速度、逻辑结构、性能价格比等属于(5)________。
* 存储器芯片选定、片选译码电路设计、主存不见组成链接等则属于(6)______。

---
答案：(1)(4)系统结构、(2)(5)组成、(3)(6)实现。

##### 模拟和仿真
* 用 *机器语言程序* 解释实现程序移植的方法称为 *模拟*
* 用 *微程序* 直接解释另一种机器的指令系统称为 *仿真*

##### 软、硬件取舍的基本原则

* 软件的特点：*灵活性* 
    - 提高软件功能比例可以提高系统的灵活性和适应性（√）
    - 软件提高系统的解题速度、性价比（X）
    - 提高硬件功能比例可以提高运算速度、减小存储容量（√）

# 第二章·计算机系统结构的合成

##### 浮点数的表示

* 尾数（r_m）
    - 尾数决定精度。
* 阶码
    - 阶码影响数值的表示范围。

##### 指令优化
    指令由操作码和地址码组成。

* 要会怎么使用扩展编码，码扩展！

* 之80和百分之20的定律
    - 从数据分析可见，程序的80%是存取、转移、算逻运算等简单指令，复杂指令的使用仅占20%。但为复杂指令而设置的微程序却占微程序ROM的80%。
    - 复杂指令增加而使CPU结构趋于复杂，对编译程序的优化好处不大，因此提出了精简指令集计算机RISC，传统计算机称为复杂指令集计算机CISC。


# 第三章·存储系统结构

##### 替换算法的分析

* 唯一一种不属于堆栈型的替换算法是___________
    - 先进先出
    - 最近最少使用
    - 最优
    - 最久未使用

---
答案：先进先出

##### 解决Cache不一致性

* 写回法
    - 仅在被替换时才将修改过的Cache块写回主存
    - 如果程序执行过程中要对某块的某单元进行写操作，则只向Cache写入，并标志注明，直至该块在替换中被排挤出来，才将该块写回主存，代替未经修改的原本。
* 写直达法
    - 修改Cache的同时也直接写入主存
    - 在写入Cache的同时也写入主存，使原本和副本同时修改。
* 写回法的写操作速度较快，但在该块回到主存之前，主存中的原本由于未及时修改而失去时效。
* 写直达的实现方法简单，而且能随时保持原本的时效，这对于多处理机共享一个原本特别重要。
* 从可靠性讲，写直达法比写回法要好。当Cache出错，写直达法可以依靠主存进行纠正，因此Cache中只需要一位奇偶校验位。写回法由于有效的块（行）只在Cache中，因此在Cache内需要采用纠错码，增加冗余信息位来提高其内容的可靠性。
* 从实现成本上，写回发比写直达法要低得多。写直达法需要较多的缓冲器和大量其他辅助逻辑减少cpu为等待写主存完成所耗费的时间。


# 第四章·流水线结构

* 流水线是从是时间层面来提高并行性。
* 指令的重叠执行，不是提高单条指令的速度，而是提高整体程序。会把一条指令的时间给延长的。
* 流水线把一条指令的过程分解成若干个子过程，子过程可以跟其他指令的子过程同时执行。

##### 流水线的特点

* 可以划分为若干互有联系的子过程（功能段），每个功能段有专用功能部件实现。
* 实现子过程层的功能段所需时间尽可能相等，避免因不等产生处理的瓶颈，形成流水线线“断流”
* 形成流水处理，需要一段时间准备，称为“通过时间”，只有在此之后流水过程才能够稳定。
* 指令流不能顺序执行时，会使流水过程中断，再形成流水过程则需要一段时间，所以流水过程不应常“断流”，否则效率不会很高。
* 流水技术适用于大量重复的过程，只有输入端能连续地提供服务，流水线效率才能够充分发挥。

流水线当中流经时间最长的子过程，称之为瓶颈段/瓶颈子过程。

---
##### 流水线的分类
* 按完成的功能分类
    - 单功能流水线
    - 多功能流水线
* 按同一时间内各段时间的连接方式分类
    - 静态流水线。同一时间内，流水线的各段只能按同一种连接方式工作。
    - 动态流水点。同一时间内，流水线的各段可按不同运算的连接方式工作。

----

##### 非线性流水线处理机

* 非线性流水线的表示和线性流水线还有两个明显的不同；
    - 非线性流水线有反馈线和前馈线。
    - 其输出端可以不在最后一个功能段，而可能从中间任意一个功能段输出。

* 一张非线性流水线的预约表可能与多张功能连接图对应；一张功能连接图也可能对应多张预约表。

---

##### 超标量处理机和超流水线
    超标量机器是为改善标量指令执行性能而设计的机器，是高性能通用处理器发展的一个方向。

* 超标量处理机和超流水线的区别：
    - 超标量通过重复设置，通过开发空间并行性，多个操作部件重复设置。
    - 超标量方法的实现取决于指令并行执行的程度，主要借助 *硬件资源重复*工作来实现 *空间*的并行操作。
    - 超流水线开发时间的并行性。
    - 超流水线处理机是通过各部分 *硬件的充分重叠工作*来提高处理机性能的
* 超标量处理机·特点
    - 配置多个性能不同的处理部件，采用多条流水线并行处理。
    - 同时对若干条指令进行译码，将可执行的指令送往不同部件，达到在一个时钟周期内启动多条指令的目的。
    - 在程序执行期间由硬件（状态记录部件和调度部件）完成指令调度。

---

*重点：* 数据相关处理（PPT例题，必考）和 非线性流水线

# 第五章·并行处理机

##### 并行性概念
    并行性定义为：在同一时刻或同一时间间隔内完成两种或两种以上的性质相同或不同的工作，
    只要在时间上相互重叠，均存在并行性。

* 并行性的等级
    - 从执行角度，从低到高
        + 指令内部并行，即指令内部的微操作之间的并行。
        + 指令间并行，即并行执行两条或多条指令。
        + 任务级或过程级并行，即并行执行两个或多个过程或任务（程序段）
        + 作业或程序级并行，即在多个作业或程序间并行。 
    - 从处理数据的角度看，从低祷告
        + 字串位串，同时只对一个字的一位进行处理，不存在并行性；
        + 字串位并，同时读一个字的所有位进行处理，已开始出现并行性；
        + 字并位串，同时对多个字的同一位（如位片机）进行处理；
        + 字并位并（全并行），对多个字的所有位或部分位进行同时处理，这是最高一级的并行。

* 计算机系统提高并行性措施的 *技术途径*
    - 时间重叠
        + 多个处理过程在时间上互相错开，轮流重叠使用一套硬件的各个部件，以加快部件的周
        转而提高速度，时间重叠原则上不要求重复的硬件设备，能保证计算机系统具有较高的性能价格比；例如指令的重叠。
    - 资源重复
        + 在并行性概念中引入空间因素，重复设置硬件资源以大幅度提高计算机系统的性能。资源重复已经成为提高系统并行性的有效手段。
    - 资源共享
        + 利用软件方法，使多个用户分时使用同一个计算机系统。例如，多道程序，分时系统；它是提高计算机系统资源利用率的有效措施。
##### 单级互连函数

* 三维那边立方体单级互连网络
    - 8个结点的有3个方体置换函数（3位，每位取反各一种）
* 混洗单级置换函数
    - 输入端分成相等的两半，前一半和后一半按需一个隔一个从头至尾依次与输入端相连。
    - 在这个互联网中，经过 *n=log(2)(N)*次混洗连接后，除了地址码为全0和全1的结点外，其余结点都有与其他结点链接的机会。 
    - 它无法实现地址码为全0或全1的结点与其他结点链接，因此在这个网络内增加交换互连函数Cube,构成 *混洗交换单级互连网络*。最远的两个结点间链接需要经过n次交换和(n-1)次混洗，所以最大寻径距离为(2n-1)。

# 第六章·多处理机系统

##### 多处理机的基本结构

* 松散耦合多处理机结构
    - 常用通道或通信线路来实现。
    - 是低频带的
* 紧密耦合多处理机机构       
    - 用高速总线或高速开关实现。
    - 是高频带的。
* 多处理需要特殊的指令来调试并发关系，控制任务的执行
* 它的指令系统必须要支持实现过程级并发功能的高级语言，为有效地处理数据结构提供充分条件。
* 它的指令系统内应有连接、循环结构、参数处理、多维下标计算和地址界限检查等指令。

---

* 并行处理任然属于单机系统的范畴
* 并行处理机不需要专门的指令来表示并发关系（多处理机需要的）

---

### SIMD\多核CPU\多处理机技术的应用领域

1、SIMD是指单指令多数据流，在一条单独的指令中同时执行多个运算操作；
2、多核CPU是指在一片处理器中包含两个或两个以上独立的内核；
3、多处理器是由不同芯片上的多个处理器组成；
4、SIMD一次性获得所有操作数进行运算，适合应用于计算密集型的场合，如大规模的超级计算机；
5、多核CPU共享使用内存，通过芯片内部总线通信，适合运行小中型任务，如常见的个人计算机。
6、多处理器使用各自独立的线程和缓存管理，适合运行多个大型程序，如较高端的个人计算机。

# 重点·大题

* 非线性流水线
    - 根据给的预约表找到冲突向量把状态图画出来，找到所有的循环，算出平均启动时间最短的循环
    - 简单循环：每个状态只出现一次的等待时间循环
    - 迫切循环：从各自初态状态输出的边缘都具有最小等待时间，即平均等待时间比其他等待时间更小。首先必须是简单循环，其次平均等待时间比其他简单循环更小。


* 数据相关 
    - 根据例子找出所有的相关，使用其中一个调度策略"顺序调度，乱序发射"的调度策略,画出时空图，然后得出整体程序的运行时间
    - 顺序发射顺序完成
    - 顺序发射乱序完成
    - 数据相关
        + 执行本条指令的过程中，如果用到的指令、操作数、变址量等是前面指令的执行结果
    - 控制相关
        + 由条件分支指令、转子程序指令、中断等引起的相关
    - 顺序流动方式
        + 任务按顺序流入流水线，也按顺序流出流水线
    - 乱序流动方式
        + 指令流出流水线的顺序与流入流水线的顺序不同
        + 在乱序流动中可能发生：*写写相关*、*写读相关*、*读写相关*
        + $TP_{max} = \frac{1}{max{t}}$
        + $TP_{实际吞吐率} = \frac{TP_{max}}{1 + \frac{m-1}{n}}$ (流水线由m段组成，要完成n个任务)
        + 加速比：$ S = \frac{m}{1+\frac{m-1}{n}} = \frac{T_{非流水}}{T_{流水}}$
        + 效率：$ E = \frac{任务占用的时空区}{段总的时空区}$

* 编码
* OPENMP代码
    - 头文件：#include "omp.h"
    - omp_set_num_threads(8)  //分配线程数
    - #pragma omp parallel for reduction(k) 
        





